#!/bin/sh
if ( test "$1" = "" || test "$2" = "") then
   echo "Usage:  ./build VERSION_NUMBER_NCI VERSION_NUMBER_REGULAR [all|continual]"
   echo "NCI should usually be .01 higher than regular version number"
   exit 1
fi
./set-version $1
cd ..
if (test $3) then
   rm -rf boinc
   ./qcn/getboinc
else
   # at least update boinc cvs?
   svn update boinc
fi
if ( test "`uname -s`" = "Darwin" ) then
cd qcn
chmod uog+rx build.mac
make distclean
./_autosetup
./configure --disable-client --disable-server --disable-manager --disable-fcgi
cp config.h.mac config.h
./build.mac $3 $4
else
cd boinc
make distclean
./_autosetup
./configure --disable-client --disable-server --disable-manager --disable-fcgi
make clean && make
cd ../qcn
make distclean
./_autosetup
./configure --enable-client-release --disable-server
make clean
make
fi
cd client/bin
./deploy $1 $2 $3 $4
